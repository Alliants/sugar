function _ajax_request(a,c,e,b,d){if(jQuery.isFunction(c)){e=c;c={}}return jQuery.ajax({type:d,url:a,data:c,success:e,dataType:b})}jQuery.extend({put:function(a,c,d,b){return _ajax_request(a,c,d,b,"PUT")},delete_:function(a,c,d,b){return _ajax_request(a,c,d,b,"DELETE")}});(function(){var a={getSelection:function(){var b=this.jquery?this[0]:this;return(("selectionStart" in b&&function(){var c=b.selectionEnd-b.selectionStart;return{start:b.selectionStart,end:b.selectionEnd,length:c,text:b.value.substr(b.selectionStart,c)}})||(document.selection&&function(){b.focus();var d=document.selection.createRange();if(d===null){return{start:0,end:b.value.length,length:0}}var c=b.createTextRange();var e=c.duplicate();c.moveToBookmark(d.getBookmark());e.setEndPoint("EndToStart",c);return{start:e.text.length,end:e.text.length+d.text.length,length:d.text.length,text:d.text}})||function(){return{start:0,end:b.value.length,length:0}})()},replaceSelection:function(){var b=this.jquery?this[0]:this;var c=arguments[0]||"";return(("selectionStart" in b&&function(){b.value=b.value.substr(0,b.selectionStart)+c+b.value.substr(b.selectionEnd,b.value.length);return this})||(document.selection&&function(){b.focus();document.selection.createRange().text=c;return this})||function(){b.value+=c;return this})()}};jQuery.each(a,function(b){jQuery.fn[b]=this})})();function B3STabs(a,b){a.tabs=[];settings=jQuery.extend({showFirstTab:true},b);a.hideAllTabs=function(){jQuery(this.tabs).each(function(){jQuery(this.tabId).hide();jQuery(this).removeClass("active")})};a.showTab=function(c){this.hideAllTabs();jQuery(c.tabId).show();jQuery(c).addClass("active")};jQuery(a).find("a").each(function(){this.container=a;this.tabId=this.href.match(/(#[\w\d\-_]+)$/)[1];a.tabs.push(this);jQuery(this).click(function(){this.container.showTab(this);return true})});a.hideAllTabs();if(settings.showFirstTab){a.showTab(a.tabs[0])}this.controls=a;this.tabs=this.controls.tabs}function jRichTextArea(b,a){this.textArea=b;settings=jQuery.extend({className:"richTextToolbar"},a);this.toolbar={settings:settings,textArea:b,listElement:false,buttons:[],addButton:function(f,g,e){settings=jQuery.extend({className:f.replace(/[\s]+/,"")+"Button"},e);var c=document.createElement("li");var d=document.createElement("a");d.title=f;d.textArea=this.textArea;jQuery(d).click(g);jQuery(d).addClass(settings.className);jQuery(c).append(d).appendTo(this.listElement);this.buttons.push(c);return this},create:function(){if(!this.listElement){this.listElement=document.createElement("ul");jQuery(this.listElement).addClass(this.settings.className);jQuery(this.listElement).insertBefore(this.textArea)}}};this.textArea.selectedText=function(){return jQuery(this).getSelection().text};this.textArea.replaceSelection=function(c){return jQuery(this).replaceSelection(c)};this.textArea.wrapSelection=function(){var d=arguments[0];var c=(arguments.length>1)?arguments[1]:d;return this.replaceSelection(d+this.selectedText()+c)};this.textArea.toolbar=this.toolbar;this.toolbar.create()}var B3S={applyTabs:function(){jQuery("#reply-tabs").each(function(){window.replyTabs=new B3STabs(this,{showFirstTab:false});if(jQuery("body.last_page").length>0){window.replyTabs.controls.showTab(window.replyTabs.tabs[0])}})},applyRichText:function(){jQuery("textarea.rich").each(function(){var a=new jRichTextArea(this);a.toolbar.addButton("Bold",function(){this.textArea.wrapSelection("<strong>","</strong>")}).addButton("Italics",function(){this.textArea.wrapSelection("<em>","</em>")}).addButton("Link",function(){var c=this.textArea.selectedText();var b=prompt("Enter link URL","");this.textArea.replaceSelection('<a href="'+(b===""?"http://link_url/":b).replace(/^(?!(f|ht)tps?:\/\/)/,"http://")+'">'+((c==="")?"Link text":c)+"</a>")}).addButton("Image",function(){var c=this.textArea.selectedText();if(c===""){var b=prompt("Enter image URL","");if(b===null){return}this.textArea.replaceSelection('<img src="'+b+'" alt="" />')}else{this.textArea.replaceSelection('<img src="'+c+'" alt="" />')}}).addButton("Block Quote",function(){this.textArea.wrapSelection("<blockquote>","</blockquote>")}).addButton("Escape HTML",function(){var b=this.textArea.selectedText();this.textArea.replaceSelection(b.replace(/</g,"&lt;").replace(/>/g,"&gt;"))})})},init:function(){this.applyTabs();this.applyRichText();jQuery("#search_mode").change(function(){this.parentNode.action=this.value});if(jQuery("body.discussion").length>0){window.addToReply=function(a){window.replyTabs.controls.showTab(window.replyTabs.tabs[0]);jQuery("#compose-body").val(jQuery("#compose-body").val()+a)}}window.quotePost=function(a){var b="#post-"+a;if(jQuery(b).length>0){var d=jQuery(b+" .post_info .permalink a").get()[0].href.replace(/^https?:\/\/([\w\d\.:\-]*)/,"");var f=jQuery(b+" .post_info .username a").text();var c=jQuery(b+" .body .content").html().replace(/^[\s]*/,"").replace(/[\s]*$/,"").replace(/<br[\s\/]*>/g,"\n");var e='<blockquote><cite>Posted by <a href="'+d+'">'+f+"</a>:</cite>"+c+"</blockquote>";addToReply(e)}};if(jQuery("#napkin").length>0){window.uploadDrawing=function(){jQuery("#napkin-submit").text("Posting, please wait...");swfobject.getObjectById("napkin").uploadDrawing()};window.onDrawingUploaded=function(a){window.location.reload()};jQuery(".drawing img").each(function(){jQuery(this).click(function(){if(swfobject.getObjectById("napkin")){swfobject.getObjectById("napkin").setBackground(this.src)}})})}}};jQuery(document).ready(function(){B3S.init()});